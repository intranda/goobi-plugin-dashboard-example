<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:composite="http://xmlns.jcp.org/jsf/composite"
	xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:x="http://myfaces.apache.org/tomahawk"
	xmlns:intranda="http://xmlns.jcp.org/jsf/composite/composites" xmlns:pt="http://xmlns.jcp.org/jsf/passthrough" xmlns:p="http://primefaces.org/ui">

	<composite:interface>
	</composite:interface>

	<composite:implementation>

		<div class="row">
			<div class="col-sm-6">

				<h:panelGroup rendered="#{DashboardForm.plugin.assignedSteps.size() gt 0}">
					<div class="box box-color box-bordered">
						<div class="box-title">
							<h3>
								<i class="fa fa-list"></i>
								<h:outputText value="#{msgs.assignedSteps}" />
							</h3>
						</div>
						<div class="box-content nopadding">
	
							<h:form>
								<table class="table table-hover responsive">
									<tbody>
	
										<ui:repeat var="item" value="#{DashboardForm.plugin.assignedSteps}">
											<tr>
	
												<td>#{item.prozess.titel}</td>
												<td>#{item.titel}</td>
												<td>
	
													<!-- Bearbeitung Ã¼bernehmen-Schaltknopf -->
													<h:commandLink id="take" styleClass="btn btn-primary" rel="tooltip" action="#{AktuelleSchritteForm.SchrittDurchBenutzerUebernehmen}"
														rendered="#{(item.bearbeitungsstatusEnum == 'OPEN' and !item.batchStep) or (item.bearbeitungsstatusEnum == 'OPEN' and item.batchStep and !item.batchSize)}"
														title="#{msgs.bearbeitungDiesesSchrittsUebernehmen}">
														<i class="fa fa-check"></i>
														<f:passThroughAttribute name="data-toggle" value="tooltip" />
														<f:setPropertyActionListener target="#{AktuelleSchritteForm.mySchritt}" value="#{item}" />
													</h:commandLink>
			
													<!-- Bearbeiten-Schaltknopf (eigener Schritt) -->
													<h:commandLink action="task_edit" id="view1" styleClass="btn btn-warning" rel="tooltip"
														rendered="#{(item.bearbeitungsstatusEnum == 'INWORK' and item.bearbeitungsbenutzer.id == LoginForm.myBenutzer.id and !item.batchStep) or (item.bearbeitungsstatusEnum == 'INWORK' and item.bearbeitungsbenutzer.id == LoginForm.myBenutzer.id and item.batchStep and !item.batchSize)}"
														title="#{msgs.inBearbeitungDurch}: #{item.bearbeitungsbenutzer!=null and item.bearbeitungsbenutzer.id!=0 ? item.bearbeitungsbenutzer.nachVorname:''}">
														<i class="glyphicon-cogwheel"></i>
														<f:passThroughAttribute name="data-toggle" value="tooltip" />
														<f:setPropertyActionListener target="#{AktuelleSchritteForm.mySchritt}" value="#{item}" />
													</h:commandLink>
			
													<!-- Bearbeiten-Schaltknopf (fremder Schritt) -->
													<h:commandLink action="task_edit" id="view2" styleClass="btn" rel="tooltip"
														rendered="#{item.bearbeitungsstatusEnum == 'INWORK' and item.bearbeitungsbenutzer.id != LoginForm.myBenutzer.id and (!item.batchStep or !item.batchSize)}"
														title="#{msgs.inBearbeitungDurch}: #{(item.bearbeitungsbenutzer!=null and item.bearbeitungsbenutzer.id!=0 ? item.bearbeitungsbenutzer.nachVorname : '')}">
														<i class="glyphicon-old_man"></i>
														<f:passThroughAttribute name="data-toggle" value="tooltip" />
														<f:setPropertyActionListener target="#{AktuelleSchritteForm.mySchritt}" value="#{item}" />
													</h:commandLink>
			
													<!-- edit batch step -->
													<h:commandLink id="batch" styleClass="btn btn-primary" rel="tooltip" action="#{AktuelleSchritteForm.TakeOverBatch}"
														rendered="#{item.bearbeitungsstatusEnum == 'OPEN' and item.batchStep and item.batchSize}"
														title="#{msgs.bearbeitungDiesesSchrittsUebernehmen}">
														<i class="fa fa-check" style="margin-left:-6px"></i>
														<i class="fa fa-check" style="margin-left:-5px;margin-right:-6px"></i>
														<f:passThroughAttribute name="data-toggle" value="tooltip" />
														<f:setPropertyActionListener target="#{AktuelleSchritteForm.step}" value="#{item}" />
													</h:commandLink>
			
													<!-- edit batch step -->
													<h:commandLink id="batchInWork" styleClass="btn btn-warning" rel="tooltip" action="#{AktuelleSchritteForm.BatchesEdit}"
														rendered="#{item.bearbeitungsstatusEnum == 'INWORK' and item.bearbeitungsbenutzer.id == LoginForm.myBenutzer.id and item.batchStep and item.batchSize}"
														title="#{msgs.inBearbeitungDurch}: #{(item.bearbeitungsbenutzer!=null and item.bearbeitungsbenutzer.id!=0 ? item.bearbeitungsbenutzer.nachVorname : '')}">
														<i class="glyphicon-cogwheels"></i>
														<f:passThroughAttribute name="data-toggle" value="tooltip" />
														<f:setPropertyActionListener target="#{AktuelleSchritteForm.step}" value="#{item}" />
													</h:commandLink>
			
													<!-- edit batch step -->
													<h:commandLink id="batchInWorkOther" styleClass="btn" rel="tooltip" action="#{AktuelleSchritteForm.BatchesEdit}"
														rendered="#{item.bearbeitungsstatusEnum == 'INWORK' and item.bearbeitungsbenutzer.id != LoginForm.myBenutzer.id and item.batchStep and item.batchSize}"
														title="#{msgs.inBearbeitungDurch}: #{(item.bearbeitungsbenutzer!=null and item.bearbeitungsbenutzer.id!=0 ? item.bearbeitungsbenutzer.nachVorname : '')}">
														<i class="glyphicon-old_man"></i>
														<f:passThroughAttribute name="data-toggle" value="tooltip" />
														<f:setPropertyActionListener target="#{AktuelleSchritteForm.step}" value="#{item}" />
													</h:commandLink>
	
												</td>
											</tr>
										</ui:repeat>
									</tbody>
								</table>
							</h:form>
						</div>
					</div>
				</h:panelGroup>

				<h:form id="myform" styleClass="form-horizontal form-bordered" onkeypress="submitOnEnter(event);">

					<div class="row">
						<div class="col-sm-12">
							<div class="box box-color orange box-bordered">
								<div class="box-title">
									<h3>
										<i class="fa fa-search"></i>
										<h:outputText value="#{msgs.suche}" />
									</h3>
								</div>
								<div class="box-content nopadding">

									<div class="form-group">
										<h:outputLabel styleClass="control-label col-sm-5" value="#{msgs.nachEinemBandSuchen}:" />
										<div class="col-sm-7">
											<x:inputText styleClass="form-control" value="#{ProzessverwaltungForm.filter}" />
										</div>
									</div>


									<div class="form-group">
										<h:outputLabel styleClass="control-label col-sm-5" value="#{msgs.showClosedProcesses}:" />
										<div class="col-sm-7">
											<h:selectBooleanCheckbox style="margin-left: 0px;" value="#{ProzessverwaltungForm.showClosedProcesses}" />
										</div>
									</div>



									<div class="form-actions">
										<!-- search -->
										<h:commandLink styleClass="btn btn-success submitOnEnter pull-right font-size-s margin-bottom-most" id="absenden" type="submit"
											action="#{ProzessverwaltungForm.FilterAlleStart}">
											<i class="fa fa-search margin-right-5"></i>
											<h:outputText value="#{msgs.search}" />
											<f:setPropertyActionListener target="#{NavigationForm.aktuell}" value="a22" />
										</h:commandLink>
									</div>

								</div>
							</div>
						</div>

					</div>
				</h:form>
			</div>

			<div class="col-sm-6">

				<div class="box box-color box-bordered">
					<div class="box-title">
						<h3>
							<i class="fa fa-globe"></i>
							<h:outputText value="#{msgs.latestExports}" />
						</h3>
						<h:form>
							<div class="actions">
								<a href="http://orka.bibliothek.uni-kassel.de/viewer/rss/" class="btn btn-mini" title="#{msg.rssSubscribe}" target="_blank"> <i class="fa fa-rss" />
								</a>
								<h:commandLink styleClass="btn btn-mini" action="#{NavigationForm.Reload}"
									title="#{NavigationForm.uiStatus.dashboard_rss eq 'up'?msgs.showBoxDetailsOn:msgs.showBoxDetailsOff}">
									<i class="fa #{NavigationForm.uiStatus.dashboard_rss eq 'down'?'fa-angle-up':'fa-angle-down'}" />
									<f:setPropertyActionListener target="#{NavigationForm.uiStatus.dashboard_rss}"
										value="#{NavigationForm.uiStatus.dashboard_rss eq 'down'?'up':'down'}" />
								</h:commandLink>
							</div>
						</h:form>
					</div>
					<div class="box-content">
						<ui:repeat value="#{DashboardForm.plugin.feed}" var="feed" varStatus="status">

							<h:panelGroup rendered="#{status.index lt 3 or NavigationForm.uiStatus.dashboard_rss eq 'down'}" styleClass="margin-sides-10 block">

								<h:panelGroup rendered="#{not status.first}">
									<hr style="margin: 10px" />
								</h:panelGroup>

								<div class="row">
									<h:outputText escape="false" value="#{feed.title}" />
								</div>

								<div class="row margin-top-more">
									<h:outputText escape="false" value="#{feed.description}" />
								</div>
							</h:panelGroup>
						</ui:repeat>
					</div>
				</div>
			</div>

		</div>
	</composite:implementation>

</ui:composition>