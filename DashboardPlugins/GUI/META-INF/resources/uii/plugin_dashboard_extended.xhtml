<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:composite="http://xmlns.jcp.org/jsf/composite"
	xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:x="http://myfaces.apache.org/tomahawk"
	xmlns:intranda="http://xmlns.jcp.org/jsf/composite/composites" xmlns:pt="http://xmlns.jcp.org/jsf/passthrough" xmlns:p="http://primefaces.org/ui">

	<composite:interface>
	</composite:interface>

	<composite:implementation>

		 <f:metadata>
            <f:event type="preRenderView" listener="#{DashboardForm.plugin.processHelper.loadProcessTemplates}" />
        </f:metadata>

		<div class="row">
			<ui:include src="plugin_dashboard_include_batches.xhtml" />
		</div>
		
		<div class="row">
			<div class="col-sm-4">
				<ui:include src="plugin_dashboard_include_tasks.xhtml" />
				<ui:include src="plugin_dashboard_include_search.xhtml" />
				<ui:include src="plugin_dashboard_include_html_box.xhtml" />				
			</div>

			<div class="col-sm-4">
				<ui:include src="plugin_dashboard_include_statisticsProcesses.xhtml" />
				<ui:include src="plugin_dashboard_include_processTemplates.xhtml" />
				<h:panelGroup rendered="#{DashboardForm.plugin.itmHelper.showItm and LoginForm.maximaleBerechtigung le 2}">
					<ui:include src="plugin_dashboard_include_itm.xhtml" />	
				</h:panelGroup>		
			</div>
			
			<div class="col-sm-4">
				<h:panelGroup rendered="#{DashboardForm.plugin.rssHelper.showRss}">
					<ui:include src="plugin_dashboard_include_rss.xhtml" />
				</h:panelGroup>
				
				<h:panelGroup rendered="#{DashboardForm.plugin.nagiosHelper.showNagios and LoginForm.maximaleBerechtigung le 2}">
					<ui:include src="plugin_dashboard_include_nagios.xhtml" />	
				</h:panelGroup>	
			</div>
		</div>
		
		<script src="plugin_dashboard_extended_tags.js"></script>
		<script>
		    var language = "#{SpracheForm.locale.language}"
			fetch("/goobi/api/messages/" + language).then(resp => {
		        resp.json().then(msgs => {
					window.mountRssFeed(
				        document.getElementById("jsRssFeed"),
				        {
				            msgs: msgs,
				            show: "#{NavigationForm.uiStatus.dashboard_rss}"
				        }
				    );
	        	})
	        })
		</script>
	</composite:implementation>

</ui:composition>